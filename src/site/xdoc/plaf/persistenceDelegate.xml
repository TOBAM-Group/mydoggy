<!DOCTYPE document PUBLIC
        "-//Apache Software Foundation//DTD XDOC 1.0//EN"
        "http://maven.apache.org/dtd/xdoc_1_0.dtd">
<document>
    <properties>
        <title>MyDoggy - My Java Docking Framework (PLAF) : PersistenceDelegate</title>
        <author email="adecaro@users.sourceforge.net">Angelo De Caro</author>
    </properties>

    <body>

        <section name="PersistenceDelegate">
            <p>
                This interface provides useful methods to save and load the tool window manager's workspace.
                When you request to save the workspace, all settings of ToolWindows with relative descriptors are saved.
                To obtain an instance of PersistenceDelegate you have to invoke the method
                <code>getPersistenceDelegate</code>
                of
                <code>ToolWindowManager</code>
                interface. So you can obtain a persistence delegate specific to a
                particular tool window manager.
            </p>
            <p>
                When you request to save the workspace, all settings of toolwindows, and not only, with relative descriptors are saved.
                See the specific DTD, relative to the version of mydoggy that you are using, to know all information saved.
                <br/>

                To obtain the instance of the PersistenceDelegate for a specific ToolWindowManager use the following:
            </p>
            <source>PersistenceDelegate pstDelegate = twManager.getPersistenceDelegate();</source>

            <p>
                MyDoggy arrives with a default implementation provided by
                <br/>
                <code>org.noos.xing.mydoggy.plaf.persistence.xml.XMLPersistenceDelegate</code>
                <br/>
                This implementation use the xml format to store all necessary data.
                <br/>
                <br/>
                You can found the relative DTD
            </p>
            <ul>
                <li>
                    1.4.2 <a href="./resources/dtd/persistence_1_4_2.dtd">here</a>.
                </li>
                <li>
                    1.4.1 <a href="./resources/dtd/persistence_1_4_1.dtd">here</a>.
                </li>
                <li>
                    1.4.0 <a href="./resources/dtd/persistence_1_4_0.dtd">here</a>.
                </li>
                <li>
                    1.3.1 <a href="./resources/dtd/persistence_1_3_1.dtd">here</a>.
                </li>
                <li>
                    1.3.0 <a href="./resources/dtd/persistence_1_3_0.dtd">here</a>.
                </li>
                <li>
                    1.2.0 <a href="./resources/dtd/persistence_1_2_0.dtd">here</a>.
                </li>
            </ul>

            <p>
                Here is an example of a saved workspace.
            </p>

            <source xml:space="preserve">
&lt;?xml version="1.0" standalone="yes"?&gt;

&lt;mydoggy version="1.4.2" contentManagerEnabled="true"&gt;
    &lt;toolWindows&gt;
        &lt;toolWindow id="Tool 1" available="true" visible="false" active="false" autoHide="true" anchor="LEFT" anchorIndex="1" type="DOCKED" aggregateMode="false" maximized="false" index="1" representativeAnchorButtonVisible="true" flashing="false"&gt;
            &lt;descriptors&gt;
                &lt;docked dockLength="200" minimumDockLength="100" popupMenuEnabled="true" animating="true" previewEnabled="true" previewDelay="1000" previewTransparentRatio="0.65" hideRepresentativeButtonOnVisible="false" idVisibleOnTitleBar="true" autoHide="true"/&gt;
                &lt;sliding transparentMode="true" transparentDelay="1000" transparentRatio="0.5" enabled="true" animating="true" idVisibleOnTitleBar="true" autoHide="true"/&gt;
                &lt;floating modal="false" transparentMode="true" transparentDelay="0" transparentRatio="0.7" enabled="true" animating="true" idVisibleOnTitleBar="true" autoHide="false" addToTaskBar="false"/&gt;
                &lt;floatingLive transparentMode="true" transparentDelay="1000" transparentRatio="0.5" enabled="true" animating="true" idVisibleOnTitleBar="true" autoHide="false"/&gt;
            &lt;/descriptors&gt;
        &lt;/toolWindow&gt;
    &lt;/toolWindows&gt;
    &lt;toolWindowManagerDescriptor numberingEnabled="true" previewEnabled="true" showUnavailableTools="false"&gt;
        &lt;pushAway pushAwayMode="VERTICAL"&gt;
            &lt;mode type="MOST_RECENT"&gt;
                &lt;anchor type="TOP"/&gt;
                &lt;anchor type="RIGHT"/&gt;
                &lt;anchor type="BOTTOM"/&gt;
                &lt;anchor type="LEFT"/&gt;
            &lt;/mode&gt;
        &lt;/pushAway&gt;
    &lt;/toolWindowManagerDescriptor&gt;
    &lt;contentManagerUI&gt;
        &lt;MultiSplitContentManagerUI closeable="true" detachable="true" minimizable="true" showAlwaysTab="false" tabLayout="WRAP" tabPlacement="BOTTOM"&gt;
            &lt;contents&gt;
                &lt;content id="Welcome" showAlwaysTab="true"/&gt;
            &lt;/contents&gt;
            &lt;layout&gt;
                &lt;![CDATA[
&lt;java version="1.6.0_06" class="java.beans.XMLDecoder"&gt;
 &lt;object class="org.noos.xing.mydoggy.plaf.ui.cmp.MultiSplitDockableContainer$DockableLeaf"&gt;
  &lt;void property="bounds"&gt;
   &lt;object class="java.awt.Rectangle"&gt;
    &lt;int&gt;0&lt;/int&gt;
    &lt;int&gt;0&lt;/int&gt;
    &lt;int&gt;584&lt;/int&gt;
    &lt;int&gt;384&lt;/int&gt;
   &lt;/object&gt;
  &lt;/void&gt;
  &lt;void property="dockables"&gt;
   &lt;object class="java.util.ArrayList"&gt;
    &lt;void method="add"&gt;
     &lt;string&gt;Welcome&lt;/string&gt;
    &lt;/void&gt;
   &lt;/object&gt;
  &lt;/void&gt;
  &lt;void property="name"&gt;
   &lt;string&gt;1&lt;/string&gt;
  &lt;/void&gt;
  &lt;void property="weight"&gt;
   &lt;double&gt;1.0&lt;/double&gt;
  &lt;/void&gt;
 &lt;/object&gt;
&lt;/java&gt;
]]&gt;
            &lt;/layout&gt;
        &lt;/MultiSplitContentManagerUI&gt;
    &lt;/contentManagerUI&gt;
    &lt;contentManager&gt;
        &lt;contents&gt;
            &lt;content id="Welcome" detached="false" enabled="true" selected="true" maximized="false" minimized="false" flashing="false" closeable="true" detachable="true" minimizable="true" transparentMode="true" transparentDelay="0" transparentRatio="0.7" addToTaskBarWhenDetached="false"/&gt;
        &lt;/contents&gt;
    &lt;/contentManager&gt;
    &lt;toolWindowBars&gt;
        &lt;toolWindowBar anchor="LEFT" dividerSize="3" aggregateMode="false"/&gt;
        &lt;toolWindowBar anchor="BOTTOM" dividerSize="3" aggregateMode="false"/&gt;
        &lt;toolWindowBar anchor="RIGHT" dividerSize="3" aggregateMode="false"/&gt;
        &lt;toolWindowBar anchor="TOP" dividerSize="3" aggregateMode="false"/&gt;
    &lt;/toolWindowBars&gt;
&lt;/mydoggy&gt;
            </source>
        </section>

        <a name="UsingPersistenceDelegate"/>

        <section name="Using PersistenceDelegate">
            <subsection name="PersistenceDelegate">
                <p>
                    To obtain the instance of the PersistenceDelegate for a specific ToolWindowManager use the following:
                </p>
                <source>PersistenceDelegate pstDelegate = twManager.getPersistenceDelegate();</source>
            </subsection>
            <subsection name="PersistenceDelegate - Store Workspace">
                <p>
                    After you have obtained an instance of the PersistenceDelegate for a specific ToolWindowManager use
                    the following to store the workspace:
                </p>
                <source>PersistenceDelegate pstDelegate = twManager.getPersistenceDelegate();
try {
    FileOutputStream output = new FileOutputStream("workspace.xml");
    twManager.getPersistenceDelegate().save(output);
    output.close();
} catch (Exception e) {
    e.printStackTrace();
}</source>
            </subsection>
            <subsection name="PersistenceDelegate - Apply stored Workspace">
                <p>
                    After you have obtained an instance of the PersistenceDelegate for a specific ToolWindowManager use
                    the following to apply a saved workspace to the current workspace:
                </p>
                <source>PersistenceDelegate pstDelegate = twManager.getPersistenceDelegate();
try {
    FileInputStream inputStream = new FileInputStream("workspace.xml");
    pstDelegate.apply(inputStream);
    inputStream.close();
} catch (Exception e1) {
    e1.printStackTrace();
}</source>

                <p>
                    Using <code>merge(InputStream, MergePolicy)</code> method, you can decide the method's behaviour
                    relative to the tools already visible when the method is called.
                </p>
                <source>PersistenceDelegate pstDelegate = twManager.getPersistenceDelegate();
try {
    FileInputStream inputStream = new FileInputStream("workspace.xml");
    pstDelegate.merge(
                    inputStream,
                    PersistenceDelegate.MergePolicy.RESET);
    inputStream.close();
} catch (Exception e1) {
    e1.printStackTrace();
}</source>
            </subsection>
        </section>
    </body>
</document>
