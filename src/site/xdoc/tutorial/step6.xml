<!DOCTYPE document PUBLIC
		"-//Apache Software Foundation//DTD XDOC 1.0//EN"
		"http://maven.apache.org/dtd/xdoc_1_0.dtd">
<document>
	<properties>
		<title>MyDoggy - My Java Docking Framework : Tutorial - Step 6</title>
		<author email="adecaro@users.sourceforge.net">Angelo De Caro</author>
	</properties>

    <body>
		<section name="Tutorial - Step 6">
            <p>
                Now we'll play with <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowTab.html">PersistenceDelegate</a> interface.
                We'll add a WindowListener to the main frame to catch the necessary events to load and store the toolwindow manager
                workspace.
            </p>

            <source>
package org.noos.xing.mydoggy.tutorial;

import info.clearthought.layout.TableLayout;
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindow.html">import org.noos.xing.mydoggy.ToolWindow;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowAnchor.html">import org.noos.xing.mydoggy.ToolWindowAnchor;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowManager.html">import org.noos.xing.mydoggy.ToolWindowManager;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/DockedTypeDescriptor.html">import org.noos.xing.mydoggy.DockedTypeDescriptor;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/SlidingTypeDescriptor.html">import org.noos.xing.mydoggy.SlidingTypeDescriptor;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/FloatingTypeDescriptor.html">import org.noos.xing.mydoggy.FloatingTypeDescriptor;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowType.html">import org.noos.xing.mydoggy.ToolWindowType;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowActionHandler.html">import org.noos.xing.mydoggy.ToolWindowActionHandler;</a>                
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentManager.html">import org.noos.xing.mydoggy.ContentManager;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/Content.html">import org.noos.xing.mydoggy.Content;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/TabbedContentManagerUI.html">import org.noos.xing.mydoggy.TabbedContentManagerUI;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/TabbedContentUI.html">import org.noos.xing.mydoggy.TabbedContentUI;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentManagerUIListener.html">import org.noos.xing.mydoggy.ContentManagerUIListener;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/event/ContentManagerUIEvent.html">import org.noos.xing.mydoggy.event.ContentManagerUIEvent;</a>
<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowTab.html">import org.noos.xing.mydoggy.ToolWindowTab;</a>
<a href="./../mydoggy-plaf/toolwindowManager.html">import org.noos.xing.mydoggy.plaf.MyDoggyToolWindowManager;</a>

import java.io.*;
import javax.swing.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowEvent;
import java.awt.event.WindowAdapter;

public class TutorialSet {
    private JFrame frame;
    private ToolWindowManager toolWindowManager;


    protected void run() {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                setUp();
                start();
            }
        });
    }

    protected void setUp() {
        initComponents();
        initToolWindowManager();
    }

    protected void start() {
        // Activate "Debug" Tool
        ToolWindow debugTool = toolWindowManager.getToolWindow("Debug");
        debugTool.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindow.html#setActive(boolean)">setActive</a>(true);

        frame.setVisible(true);
    }

    protected void initComponents() {
        // Init the frame
        this.frame = new JFrame("Sample App...");
        this.frame.setSize(640, 480);
        this.frame.setLocation(100, 100);
        this.frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        // Create a simple JMenuBar
        JMenuBar menuBar = new JMenuBar();
        JMenu fileMenu = new JMenu("File");
        JMenuItem exitMenuItem = new JMenuItem("Exit");
        exitMenuItem.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                frame.setVisible(false);
                frame.dispose();
            }
        });
        fileMenu.add(exitMenuItem);
        menuBar.add(fileMenu);
        this.frame.setJMenuBar(menuBar);

        // Set a layout manager. I love TableLayout. It's powerful.
        this.frame.getContentPane().setLayout(new TableLayout(new double[][]{{0, -1, 0}, {0, -1, 0}}));

        // Store (on close) and load (on start) the toolwindow manager workspace.
        this.frame.addWindowListener(new WindowAdapter() {
            public void windowOpened(WindowEvent e) {
                try {
                    File workspaceFile = new File("workspace.xml");
                    if (workspaceFile.exists()) {
                        FileInputStream inputStream = new FileInputStream("workspace.xml");
                        toolWindowManager.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowManager.html#getPersistenceDelegate()">getPersistenceDelegate</a>().<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/PersistenceDelegate.html#apply()">apply</a>(inputStream);
                        inputStream.close();
                    }
                } catch (Exception e1) {
                    e1.printStackTrace();
                }
            }

            public void windowClosing(WindowEvent e) {
                try {
                    FileOutputStream output = new FileOutputStream("workspace.xml");
                    toolWindowManager.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowManager.html#getPersistenceDelegate()">getPersistenceDelegate</a>().<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/PersistenceDelegate.html#save(java.io.OutputStream)">save</a>(output);
                    output.close();
                } catch (Exception e1) {
                    e1.printStackTrace();
                }
            }
        });
    }

    protected void initToolWindowManager() {
        // Create a new instance of MyDoggyToolWindowManager passing the frame.
        <a href="./../mydoggy-plaf/toolwindowManager.html">MyDoggyToolWindowManager</a> myDoggyToolWindowManager = new MyDoggyToolWindowManager();
        this.toolWindowManager = myDoggyToolWindowManager;

        // Register a Tool.
        toolWindowManager.registerToolWindow("Debug",                      // Id
                                             "Debug Tool",                 // Title
                                             null,                         // Icon
                                             new JButton("Debug Tool"),    // Component
                                             ToolWindowAnchor.LEFT);       // Anchor

        <a href="#setupDebugTool">setupDebugTool();</a>

        // Made all tools available
        for (ToolWindow window : toolWindowManager.getToolWindows())
            window.setAvailable(true);

        <a href="#initContentManager">initContentManager();</a>

        // Add myDoggyToolWindowManager to the frame. MyDoggyToolWindowManager is an extension of a JPanel
        this.frame.getContentPane().add(myDoggyToolWindowManager, "1,1,");
    }

    <a name="setupDebugTool"/>
    protected void setupDebugTool() {
        <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindow.html">ToolWindow</a> debugTool = toolWindowManager.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowManager.html#getToolWindow(java.lang.Object)">getToolWindow</a>("Debug");

        <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/DockedTypeDescriptor.html">DockedTypeDescriptor</a> dockedTypeDescriptor = (DockedTypeDescriptor) debugTool.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindow.html#getTypeDescriptor(org.noos.xing.mydoggy.ToolWindowType)">getTypeDescriptor</a>(<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowType.html#DOCKED">ToolWindowType.DOCKED</a>);

        dockedTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/DockedTypeDescriptor.html#setDockLength(int)">setDockLength</a>(300);
        dockedTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/DockedTypeDescriptor.html#setPopupMenuEnabled(boolean)">setPopupMenuEnabled</a>(true);
        JMenu toolsMenu = dockedTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/DockedTypeDescriptor.html#getToolsMenu()">getToolsMenu</a>();
        toolsMenu.add(new AbstractAction("Hello World!!!") {
            public void actionPerformed(ActionEvent e) {
                JOptionPane.showMessageDialog(frame, "Hello World!!!");
            }
        });
        dockedTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/DockedTypeDescriptor.html#setToolWindowActionHandler(org.noos.xing.mydoggy.ToolWindowActionHandler)">setToolWindowActionHandler</a>(new ToolWindowActionHandler() {
            public void <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowActionHandler.html#onHideButtonClick(org.noos.xing.mydoggy.ToolWindow)">onHideButtonClick</a>(ToolWindow toolWindow) {
                JOptionPane.showMessageDialog(frame, "Hiding...");
                toolWindow.setVisible(false);
            }
        });
        dockedTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowTypeDescriptor.html#setAnimating(boolean)">setAnimating(true)</a>;
        dockedTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/DockedTypeDescriptor.html#setPreviewEnabled(boolean)">setPreviewEnabled</a>(true);
        dockedTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/DockedTypeDescriptor.html#setPreviewDelay(int)">setPreviewDelay</a>(1500);
        dockedTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/DockedTypeDescriptor.html#setPreviewTransparentRatio(float)">setPreviewTransparentRatio</a>(0.4f);

        <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/SlidingTypeDescriptor.html">SlidingTypeDescriptor</a> slidingTypeDescriptor = (SlidingTypeDescriptor) debugTool.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindow.html#getTypeDescriptor(org.noos.xing.mydoggy.ToolWindowType)">getTypeDescriptor</a>(<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowType.html#SLIDING">ToolWindowType.SLIDING</a>);
        slidingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/SlidingTypeDescriptor.html#setEnabled(boolean)">setEnabled(false)</a>;
        slidingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/SlidingTypeDescriptor.html#setTransparentMode(boolean)">setTransparentMode(true)</a>;
        slidingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/SlidingTypeDescriptor.html#setTransparentRatio(float)">setTransparentRatio(0.8f)</a>;
        slidingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/SlidingTypeDescriptor.html#setTransparentDelay(int)">setTransparentDelay(0)</a>;
        slidingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowTypeDescriptor.html#setAnimating(boolean)">setAnimating(true)</a>;

        <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/FloatingTypeDescriptor.html">FloatingTypeDescriptor</a> floatingTypeDescriptor = (FloatingTypeDescriptor) debugTool.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindow.html#getTypeDescriptor(org.noos.xing.mydoggy.ToolWindowType)">getTypeDescriptor</a>(<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowType.html#FLOATING">ToolWindowType.FLOATING</a>);
        floatingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/FloatingTypeDescriptor.html#setEnabled(boolean)">setEnabled(true)</a>;
        floatingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/FloatingTypeDescriptor.html#setLocation(int, int)">setLocation(150,200)</a>;
        floatingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/FloatingTypeDescriptor.html#setSize(int, int)">setSize(320,200)</a>;
        floatingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/FloatingTypeDescriptor.html#setModal(boolean)">setModal(false)</a>;
        floatingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/FloatingTypeDescriptor.html#setTransparentMode(boolean)">setTransparentMode(true)</a>;
        floatingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/FloatingTypeDescriptor.html#setTransparentRatio(float)">setTransparentRatio(0.2f)</a>;
        floatingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/FloatingTypeDescriptor.html#setTransparentDelay(int)">setTransparentDelay(1000)</a>;
        floatingTypeDescriptor.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowTypeDescriptor.html#setAnimating(boolean)">setAnimating(true)</a>;
    }
    <a name="initContentManager"/>
    protected void initContentManager() {
         JTree treeContent = new JTree();

        <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentManager.html">ContentManager</a> contentManager = toolWindowManager.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ToolWindowManager.html#getContentManager()">getContentManager</a>();
        <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/Content.html">Content</a> content = contentManager.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentManager.html#addContent(java.lang.Object, java.lang.String, javax.swing.Icon, java.awt.Component)">addContent</a>("Tree Key",
                                                    "Tree Title",
                                                    null,      // An icon
                                                    treeContent);
        content.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/Content.html#setToolTipText(java.lang.String)">setToolTipText</a>("Tree tip");

        <a href="setupContentManagerUI">setupContentManagerUI</a>();
    }
    <a name="setupContentManagerUI"/>
    protected void setupContentManagerUI() {
        <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/TabbedContentManagerUI.html">TabbedContentManagerUI</a> contentManagerUI = (TabbedContentManagerUI) toolWindowManager.getContentManager().<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentManager.html#getContentManagerUI()">getContentManagerUI</a>();
        contentManagerUI.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/TabbedContentManagerUI.html#setShowAlwaysTab(boolean)">setShowAlwaysTab</a>(true);
        contentManagerUI.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/TabbedContentManagerUI.html#setTabPlacement(org.noos.xing.mydoggy.TabbedContentManagerUI.TabPlacement.BOTTOM)">setTabPlacement</a>(TabbedContentManagerUI.TabPlacement.BOTTOM);
        contentManagerUI.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/TabbedContentManagerUI.html#addContentManagerUIListener(org.noos.xing.mydoggy.ContentManagerUIListener)">addContentManagerUIListener</a>(new <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentManagerUIListener">ContentManagerUIListener</a>() {
            public boolean contentUIRemoving(ContentManagerUIEvent event) {
                return JOptionPane.showConfirmDialog(frame, "Are you sure?") == JOptionPane.OK_OPTION;
            }

            public void contentUIDetached(ContentManagerUIEvent event) {
                JOptionPane.showMessageDialog(frame, "Hello World!!!");
            }
        });

        <a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/TabbedContentUI.html">TabbedContentUI</a> contentUI = contentManagerUI.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentManagerUI.html#getContentUI(org.noos.xing.mydoggy.Content)">getContentUI</a>(toolWindowManager.getContentManager().getContent(0));

        contentUI.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentUI.html#setCloseable(boolean)">setCloseable</a>(true);
        contentUI.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentUI.html#setDetachable(boolean)">setDetachable</a>(true);
        contentUI.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentUI.html#setTransparentMode(boolean)">setTransparentMode</a>(true);
        contentUI.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentUI.html#setTransparentRatio(float)">setTransparentRatio</a>(0.7f);
        contentUI.<a href="./../mydoggy-api/apidocs/org/noos/xing/mydoggy/ContentUI.html#setTransparentDelay(int)">setTransparentDelay</a>(1000);
    }
    
    public static void main(String[] args) {
        TutorialSet test = new TutorialSet();
        try {
            test.run();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}</source>
            <subsection name="Result">
                <table>
                    <tbody>
                        <tr>
                            <td>
                                <div align="center">
                                    <img align="middle" src="./../images/tutorial/step6.png" alt="ToolWindowTab" border="0" hspace="18"/>
                                </div>
                            </td>
                            <td>
                                <div align="left">
                                    <p>
                                        No special result to show...Just play with the app.
                                    </p>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>
                    Good! Next Step. <a href="./step7.html">Step 7</a> - ToolWindowTabs.
                </p>
            </subsection>
        </section>
    </body>
</document>
